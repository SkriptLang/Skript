name: Setup documentation environment

inputs:
  docs_deploy_key: 
    description: "Deploy key for the skript-docs repo"
    required: true
    type: string

runs:
  using: 'composite'
  steps:
    - name: setup-docs
      env:
        DOCS_DEPLOY_KEY: ${{ inputs.docs_deploy_key }}
        DOCS_OUTPUT_DIR: ${{ inputs.docs_output_dir }}
        DOCS_REPO_DIR: ${{ inputs.docs_repo_dir }}
      run: |
        eval `ssh-agent`
        rm -r ${DOCS_OUTPUT_DIR}/* || true
        echo "SKRIPT_DOCS_TEMPLATE_DIR=${DOCS_REPO_DIR}/doc-templates" >> $GITHUB_ENV
        echo "SKRIPT_DOCS_OUTPUT_DIR=${DOCS_OUTPUT_DIR}/" >> $GITHUB_ENV
        echo "$DOCS_DEPLOY_KEY" | tr -d '\r' | ssh-add - > /dev/null
        mkdir ~/.ssh
        ssh-keyscan www.github.com >> ~/.ssh/known_hosts
